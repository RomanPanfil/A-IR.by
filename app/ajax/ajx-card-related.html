<div class="card-related ui-block">
    <div class="ui-block-head">
      <div class="ui-block-title">С этим товаром покупают</div>
    </div>

    <div class="card-related-mobile ui-screen-less-1024">
      <div class="ui-scroller"></div>
    </div>

    <div class="card-related-desktop ui-screen-more-1024">
      <div class="swiper swiper-card-related">
        <div class="swiper-wrapper">
          <div class="swiper-slide">
            <div class="slider-product">
              <div class="slider-product-topline" onclick="" data-href="./popups/marks.html">
                <div class="slider-product-sticker">Мега рассрочка 0/24</div>
                <div class="slider-product-arrow">
                  <svg class="sprite slider-product-arrow-icon"><use xlink:href="svg/svg/symbols.svg#ui-arrow-next"/></svg>
                </div>
                <div class="slider-product-stickers">
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-blue">Товар недели</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-green">Ременно привод</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-purple">Умный выбор</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-red">-13%</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-orange">Купи сейчас, плати потом</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-cyan">Фильтр в подарок</a>
                </div>
              </div>

              <div class="slider-product-img">
                <a href="#" class="slider-product-img-link">
                  <img src="./images/product-img.webp" loading="lazy" alt="product">
                </a>
              </div>

              <div class="slider-product-midline">
                <div class="slider-product-rate">
                  <svg class="sprite ui-inline slider-product-rate-icon"><use xlink:href="svg/svg/symbols.svg#star"/></svg>
                  <span class="slider-product-rate-value">3.7</span>
                </div>

                <div class="slider-product-code">Код: <span class="slider-product-code-code">01020304</span></div>
              </div>

              <div class="slider-product-title"><a href="#" class="slider-product-title-link">Поршневой компрессор Delonghikeran ZZKH9991XF0, 35 бар</a></div>

              <div class="slider-product-characters">
                <div class="slider-product-character">
                  Производительность: <span class="slider-product-character-value">4 - 10 м3/мин</span>
                </div>
                <div class="slider-product-character">
                  Максимальное давление: <span class="slider-product-character-value">7.5 - 20 Бар</span>
                </div>
                <div class="slider-product-character">
                  Мощность двигателя: <span class="slider-product-character-value">2.2 - 315 кВт</span>
                </div>
              </div>

              <div class="slider-product-prices">
                <div class="slider-product-price">5 381.00 <span class="slider-product-price-unit">р</span></div>
              </div>

              <div class="slider-product-btns">
                <a href="#" class="slider-product-btn ui-btn ui-btn-midi ui-btn-block">В корзину</a>
                <a href="javascript:void(0)" class="ui-action ui-action-like">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#like"/></svg>
                </a>
                <a href="javascript:void(0)" class="ui-action ui-action-compare">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#compare"/></svg>
                </a>
              </div>

            </div><!--.slider-product-->
          </div>

          <div class="swiper-slide">
            <div class="slider-product">
              <div class="slider-product-topline" onclick="" data-href="./popups/marks.html">
                <div class="slider-product-sticker">Мега рассрочка 0/24</div>
                <div class="slider-product-arrow">
                  <svg class="sprite slider-product-arrow-icon"><use xlink:href="svg/svg/symbols.svg#ui-arrow-next"/></svg>
                </div>
                <div class="slider-product-stickers">
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-blue">Товар недели</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-green">Ременно привод</a>
                </div>
              </div>

              <div class="slider-product-img">
                <a href="#" class="slider-product-img-link">
                  <img src="https://via.placeholder.com/210x210" loading="lazy" alt="product">
                </a>
              </div>

              <div class="slider-product-midline">
                <div class="slider-product-rate">
                  <svg class="sprite ui-inline slider-product-rate-icon"><use xlink:href="svg/svg/symbols.svg#star"/></svg>
                  <span class="slider-product-rate-value">4.5</span>
                </div>

                <div class="slider-product-code">Код: <span class="slider-product-code-code">02020304</span></div>
              </div>

              <div class="slider-product-title"><a href="#" class="slider-product-title-link">Винтовой компрессор CM, 5 бар</a></div>

              <div class="slider-product-characters">
                <div class="slider-product-character">
                  Производительность: <span class="slider-product-character-value">4 - 10 м3/мин</span>
                </div>
                <div class="slider-product-character">
                  Максимальное давление: <span class="slider-product-character-value">7.5 - 20 Бар</span>
                </div>
                <div class="slider-product-character">
                  Мощность двигателя: <span class="slider-product-character-value">300 - 315 кВт</span>
                </div>
              </div>

              <div class="slider-product-prices">
                <div class="slider-product-price-red">729.00 <span class="slider-product-price-unit">р</span></div>
                <div class="slider-product-price-old">981.00 <span class="slider-product-price-unit">р</span></div>
              </div>

              <div class="slider-product-btns">
                <a href="#" class="slider-product-btn ui-btn ui-btn-midi ui-btn-block">В корзину</a>
                <a href="javascript:void(0)" class="ui-action ui-action-like active">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#like"/></svg>
                </a>
                <a href="javascript:void(0)" class="ui-action ui-action-compare disabled">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#compare"/></svg>
                </a>
              </div>

            </div><!--.slider-product-->
          </div>

          <div class="swiper-slide">
            <div class="slider-product">
              <div class="slider-product-topline" onclick="" data-href="./popups/marks.html">
                <div class="slider-product-sticker">Мега рассрочка 0/24</div>
                <div class="slider-product-arrow">
                  <svg class="sprite slider-product-arrow-icon"><use xlink:href="svg/svg/symbols.svg#ui-arrow-next"/></svg>
                </div>
                <div class="slider-product-stickers">
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-blue">Товар недели</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-green">Ременно привод</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-purple">Умный выбор</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-red">-13%</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-orange">Купи сейчас, плати потом</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-cyan">Фильтр в подарок</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-blue">Товар недели</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-green">Ременно привод</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-purple">Умный выбор</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-red">-13%</a>
                </div>
              </div>

              <div class="slider-product-img">
                <a href="#" class="slider-product-img-link">
                  <img src="https://via.placeholder.com/210x300/000/FFF" loading="lazy" alt="product">
                </a>
              </div>

              <div class="slider-product-midline">
                <div class="slider-product-rate">
                  <svg class="sprite ui-inline slider-product-rate-icon"><use xlink:href="svg/svg/symbols.svg#star"/></svg>
                  <span class="slider-product-rate-value">2.7</span>
                </div>

                <div class="slider-product-code">Код: <span class="slider-product-code-code">03020304</span></div>
              </div>

              <div class="slider-product-title"><a href="#" class="slider-product-title-link">Поршневой компрессор Delonghikeran ZZKH9991XF0, 35 бар</a></div>

              <div class="slider-product-characters">
                <div class="slider-product-character">
                  Производительность: <span class="slider-product-character-value">4 - 10 м3/мин</span>
                </div>
                <div class="slider-product-character">
                  Максимальное давление: <span class="slider-product-character-value">7.5 - 20 Бар</span>
                </div>
              </div>

              <div class="slider-product-prices">
                <div class="slider-product-price">25 999.00 <span class="slider-product-price-unit">р</span></div>
              </div>

              <div class="slider-product-btns">
                <a href="#" class="slider-product-btn ui-btn ui-btn-midi ui-btn-block ui-btn-blue">Оформить</a>
                <a href="javascript:void(0)" class="ui-action ui-action-like">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#like"/></svg>
                </a>
                <a href="javascript:void(0)" class="ui-action ui-action-compare">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#compare"/></svg>
                </a>
              </div>

            </div><!--.slider-product-->
          </div>

          <div class="swiper-slide">
            <div class="slider-product">
              <div class="slider-product-topline" onclick="" data-href="./popups/marks.html">
                <div class="slider-product-sticker">Мега рассрочка 0/24</div>
                <div class="slider-product-arrow">
                  <svg class="sprite slider-product-arrow-icon"><use xlink:href="svg/svg/symbols.svg#ui-arrow-next"/></svg>
                </div>
                <div class="slider-product-stickers">
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-blue">Товар недели</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-green">Ременно привод</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-purple">Умный выбор</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-red">-13%</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-orange">Купи сейчас, плати потом</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-cyan">Фильтр в подарок</a>
                </div>
              </div>

              <div class="slider-product-img">
                <a href="#" class="slider-product-img-link">
                  <img src="./images/product-img.webp" loading="lazy" alt="product">
                </a>
              </div>

              <div class="slider-product-midline">
                <div class="slider-product-rate">
                  <svg class="sprite ui-inline slider-product-rate-icon"><use xlink:href="svg/svg/symbols.svg#star"/></svg>
                  <span class="slider-product-rate-value">3.7</span>
                </div>

                <div class="slider-product-code">Код: <span class="slider-product-code-code">01020304</span></div>
              </div>

              <div class="slider-product-title"><a href="#" class="slider-product-title-link">Поршневой компрессор Delonghikeran ZZKH9991XF0, 35 бар</a></div>

              <div class="slider-product-characters">
                <div class="slider-product-character">
                  Производительность: <span class="slider-product-character-value">4 - 10 м3/мин</span>
                </div>
                <div class="slider-product-character">
                  Максимальное давление: <span class="slider-product-character-value">7.5 - 20 Бар</span>
                </div>
                <div class="slider-product-character">
                  Мощность двигателя: <span class="slider-product-character-value">2.2 - 315 кВт</span>
                </div>
              </div>

              <div class="slider-product-prices">
                <div class="slider-product-price">5 381.00 <span class="slider-product-price-unit">р</span></div>
              </div>

              <div class="slider-product-btns">
                <a href="#" class="slider-product-btn ui-btn ui-btn-midi ui-btn-block">В корзину</a>
                <a href="javascript:void(0)" class="ui-action ui-action-like">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#like"/></svg>
                </a>
                <a href="javascript:void(0)" class="ui-action ui-action-compare">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#compare"/></svg>
                </a>
              </div>

            </div><!--.slider-product-->
          </div>

          <div class="swiper-slide">
            <div class="slider-product">
              <div class="slider-product-topline" onclick="" data-href="./popups/marks.html">
                <div class="slider-product-sticker">Мега рассрочка 0/24</div>
                <div class="slider-product-arrow">
                  <svg class="sprite slider-product-arrow-icon"><use xlink:href="svg/svg/symbols.svg#ui-arrow-next"/></svg>
                </div>
                <div class="slider-product-stickers">
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-blue">Товар недели</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-green">Ременно привод</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-purple">Умный выбор</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-red">-13%</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-orange">Купи сейчас, плати потом</a>
                  <a href="#" class="ui-sticker ui-sticker-mini ui-sticker-cyan">Фильтр в подарок</a>
                </div>
              </div>

              <div class="slider-product-img">
                <a href="#" class="slider-product-img-link">
                  <img src="./images/product-img.webp" loading="lazy" alt="product">
                </a>
              </div>

              <div class="slider-product-midline">
                <div class="slider-product-rate">
                  <svg class="sprite ui-inline slider-product-rate-icon"><use xlink:href="svg/svg/symbols.svg#star"/></svg>
                  <span class="slider-product-rate-value">3.7</span>
                </div>

                <div class="slider-product-code">Код: <span class="slider-product-code-code">01020304</span></div>
              </div>

              <div class="slider-product-title"><a href="#" class="slider-product-title-link">Поршневой компрессор Delonghikeran ZZKH9991XF0, 35 бар</a></div>

              <div class="slider-product-characters">
                <div class="slider-product-character">
                  Производительность: <span class="slider-product-character-value">4 - 10 м3/мин</span>
                </div>
                <div class="slider-product-character">
                  Максимальное давление: <span class="slider-product-character-value">7.5 - 20 Бар</span>
                </div>
                <div class="slider-product-character">
                  Мощность двигателя: <span class="slider-product-character-value">2.2 - 315 кВт</span>
                </div>
              </div>

              <div class="slider-product-prices">
                <div class="slider-product-price">5 381.00 <span class="slider-product-price-unit">р</span></div>
              </div>

              <div class="slider-product-btns">
                <a href="#" class="slider-product-btn ui-btn ui-btn-midi ui-btn-block">В корзину</a>
                <a href="javascript:void(0)" class="ui-action ui-action-like">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#like"/></svg>
                </a>
                <a href="javascript:void(0)" class="ui-action ui-action-compare">
                  <svg class="sprite ui-action-icon"><use xlink:href="svg/svg/symbols.svg#compare"/></svg>
                </a>
              </div>

            </div><!--.slider-product-->
          </div>
        </div>

        <div class="ui-arrow ui-arrow-prev card-related-prev">
          <svg class="sprite ui-arrow-icon"><use xlink:href="svg/svg/symbols.svg#ui-arrow-prev"/></svg>
        </div>

        <div class="ui-arrow ui-arrow-next card-related-next">
          <svg class="sprite ui-arrow-icon"><use xlink:href="svg/svg/symbols.svg#ui-arrow-next"/></svg>
        </div>
      </div><!--.swiper-->
    </div>
    <script>
      (function(){
        if (!document.querySelector('.slider-product-topline')) return

        document.querySelectorAll('.slider-product-topline')
          .forEach(el => {
            el.addEventListener('click', function (event) {
              event = event || window.event
              event.preventDefault()
              event.stopPropagation()

              const url = this.dataset.href || null

              if (document.documentElement.clientWidth > 1024) {
                return event.target.closest('.slider-product').classList.toggle('opened');
              }

              if (!url) return
              $.magnificPopup.open({
                items: { src: url },
                type: "ajax",
                overflowY: "scroll",
                removalDelay: 610,
                mainClass: "my-mfp-zoom-in",
                ajax: {
                  tError: "Error. Not valid url",
                },
                // @todo добавить везде, где инициализация
                callbacks: {
                  open: function() {
                    document.documentElement.style.overflow = 'hidden'
                  },
                  close: function() {
                    document.documentElement.style.overflow = ''
                  }
                }
              });
            })
          })
      })();

      (function(){
        if (!document.querySelector('.card-related-desktop')) return
        let slider = null, native = null;

        //desktop
        if(matchMedia) {
          var bp = window.matchMedia('(min-width:1024.02px)');
          bp.addListener(changes);
          changes(bp);
        }
        function changes(bp) {
          if(bp.matches && !slider) {
            slider = new Swiper(".swiper-card-related", {
              slidesPerView: 3,
              spaceBetween: 24,
              // shortSwipes: false,
              navigation: {
                nextEl: ".card-related-next",
                prevEl: ".card-related-prev",
              },
              breakpoints: {
                1140: {
                  slidesPerView: 4,
                },
              }
            });
          }

          if (!bp.matches && !native) {
            const clone = $('.card-related-desktop .slider-product').clone();
            $('.card-related-mobile .ui-scroller').prepend(clone)
            native = true
          }
        }
      })();

    </script>
  </div>